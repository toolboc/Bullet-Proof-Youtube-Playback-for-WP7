<html xmlns="http://www.w3.org/1999/xhtml">
<head runat="server">
    <script type="text/javascript">
        function GetYoutubeUrl(input) 
        {
            var result = unescape(input);

            var patt = /url_encoded_fmt_stream_map=.*?;/g;
            var fm_stream_map_encoded = patt.exec(result);
            fm_stream_map_encoded = fm_stream_map_encoded.toLocaleString();
            fm_stream_map_encoded = fm_stream_map_encoded.slice(27, -10); //remove 'url_encoded_fmt_stream_map=' and trailing '\u0026amp;'

            var formatsGroup = fm_stream_map_encoded.split(",");

            var videoURL = new Array();

            for (var i = 0; i < formatsGroup.length; i++) {
                var videoFormatsElem = formatsGroup[i].split("&");

                var videoFormatsPair = new Array();

                for (var j = 0; j < videoFormatsElem.length; j++) {
                    var pair = videoFormatsElem[j].split("=");
                    if (pair.length == 2) {
                        videoFormatsPair[pair[0]] = pair[1];
                    }
                }

                var url = (videoFormatsPair['url']) ? videoFormatsPair['url'] : null;
                if (url == null) continue;
                url = unescape(unescape(url)).replace(/\\\//g, '/').replace(/\\u0026/g, '&');
                var itag = (videoFormatsPair['itag']) ? videoFormatsPair['itag'] : null;
                if (itag == null) continue;
                var signature = (videoFormatsPair['sig']) ? videoFormatsPair['sig'] : null;
                if (signature != null) {
                    url = url + "&signature=" + signature;
                }
                if (url.toLowerCase().indexOf('http') == 0) { // validate URL
                    videoURL[itag] = url;
                }
            }
            window.external.notify(videoURL[18].toLocaleString());
        }
    </script>
</head>
<body>
</body>
</html>